<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@300;400;600&family=Playfair+Display:italic,wght@0,700;1,700&display=swap" rel="stylesheet">
    <title>Heritage Quest | AI Vision Explorer</title>
    
    <script>
        if (localStorage.getItem('isLoggedIn') !== 'true') {
            window.location.replace("login.html");
        }
    </script>

    <style>
        :root {
            --heritage-dark: #070707;
            --gold-leaf: #d4af37;
            --deep-amber: #b45309;
        }

        body { 
            font-family: 'Inter', sans-serif; 
            background-color: var(--heritage-dark);
            color: #eee;
            overflow-x: hidden;
        }

        .hero-font { font-family: 'Cinzel', serif; }
        .italic-font { font-family: 'Playfair Display', serif; }

        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .btn-gold {
            background: linear-gradient(135deg, #f59e0b, #b45309);
            color: black;
            font-weight: 800;
            transition: all 0.3s ease;
        }

        .btn-gold:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(180, 83, 9, 0.5);
        }

        .scanner-line {
            height: 4px;
            background: #f59e0b;
            box-shadow: 0 0 30px #f59e0b;
            position: absolute;
            width: 100%;
            animation: scan 2s ease-in-out infinite;
            z-index: 20;
        }

        @keyframes scan {
            0%, 100% { top: 5%; }
            50% { top: 95%; }
        }

        .reveal { animation: reveal 1s ease-out forwards; }
        @keyframes reveal {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #whisper-overlay { 
            transition: transform 0.6s cubic-bezier(0.19, 1, 0.22, 1);
            transform: translateY(100%);
        }
        #whisper-overlay.active { transform: translateY(0); }
    </style>
</head>
<body class="relative">

    <div class="fixed inset-0 z-0">
        <img src="images/BACKGROUND.jpeg" 
             class="w-full h-full object-cover brightness-[0.35] blur-[3px]"
             alt="Indian Heritage Background">
        <div class="absolute inset-0 bg-gradient-to-b from-black/80 via-transparent to-black"></div>
    </div>

    <nav class="sticky top-0 z-[100] p-6 bg-black/30 backdrop-blur-xl border-b border-white/5">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-4 cursor-pointer" onclick="location.reload()">
                <div class="w-12 h-12 bg-gradient-to-tr from-amber-600 to-amber-400 rounded-xl flex items-center justify-center font-bold text-black hero-font text-xl shadow-lg">H</div>
                <h1 class="text-2xl font-bold hero-font tracking-[0.2em] text-white">HERITAGE <span class="text-amber-500">QUEST</span></h1>
            </div>
            
            <div class="flex items-center gap-6">
                <button id="backBtn" onclick="goBack()" class="hidden border-2 border-amber-500 text-amber-500 px-6 py-2 rounded-full hover:bg-amber-500 hover:text-black transition-all font-bold uppercase text-[10px] tracking-widest">‚Üê Back</button>
                
                <div id="auth-controls">
                    <a href="login.html" id="loginBtn" class="text-white hover:text-amber-500 font-bold uppercase text-[10px] tracking-widest transition-colors">Login</a>
                    <div id="userProfile" class="hidden flex items-center gap-4">
                        <span id="userNameDisplay" class="text-stone-400 text-[10px] font-bold tracking-widest uppercase"></span>
                        <button onclick="handleLogout()" class="border border-red-500/50 text-red-500 px-4 py-1 rounded-full text-[10px] font-bold hover:bg-red-500 hover:text-white transition-all tracking-widest">LOGOUT</button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <header id="hero-section" class="relative min-h-[90vh] flex flex-col items-center justify-center overflow-hidden px-6 z-10">
        <div class="max-w-7xl mx-auto grid lg:grid-cols-2 gap-16 items-center">
            
            <div class="text-left reveal">
                <span class="inline-block px-5 py-2 rounded-full border border-amber-500/20 bg-amber-500/10 text-amber-500 text-xs font-bold tracking-[0.4em] uppercase mb-8">AI Heritage Identification</span>
                <h2 class="text-5xl md:text-8xl hero-font leading-none mb-8 text-white">A Journey Through <br><span class="italic-font text-amber-500"> India‚Äôs Living History.</span></h2>
                
                <div class="glass-card p-6 rounded-[32px] border border-amber-500/20 mb-8 max-w-lg">
                    <h4 class="hero-font text-amber-500 text-sm tracking-widest mb-2 uppercase">Our Mission</h4>
                    <p class="italic-font text-lg text-white mb-3">"Preserving the past, <span class="text-amber-500">whispering</span> the future."</p>
                    <p class="text-stone-400 text-sm leading-relaxed mb-4">We bridge the gap between ancient legends and modern tech, ensuring India‚Äôs stories are heard in every language.</p>
                    <div class="flex gap-2 text-[9px] font-bold uppercase">
                        <span class="px-3 py-1 rounded-full bg-amber-500/10 border border-amber-500/30 text-amber-500">üéô Audio Narratives</span>
                        <span class="px-3 py-1 rounded-full bg-amber-500/10 border border-amber-500/30 text-amber-500">üß† AI Recognition</span>
                    </div>
                </div>

                <div class="grid grid-cols-3 gap-4">
                    <div class="p-4 bg-black/40 backdrop-blur-md rounded-2xl border border-white/10 text-center">
                        <p class="text-amber-500 font-bold text-2xl hero-font">12</p>
                        <p class="text-[9px] uppercase tracking-widest text-stone-400">Jyotirlingas</p>
                    </div>
                    <div class="p-4 bg-black/40 backdrop-blur-md rounded-2xl border border-white/10 text-center">
                        <p class="text-amber-500 font-bold text-2xl hero-font">10+</p>
                        <p class="text-[9px] uppercase tracking-widest text-stone-400">Nashik Temples</p>
                    </div>
                    <div class="p-4 bg-black/40 backdrop-blur-md rounded-2xl border border-white/10 text-center">
                        <p class="text-amber-500 font-bold text-2xl hero-font">15+</p>
                        <p class="text-[9px] uppercase tracking-widest text-stone-400">Historic Forts</p>
                    </div>
                </div>
            </div>

            <div class="reveal" style="animation-delay: 0.3s">
                <div class="glass-card p-1 rounded-[48px] overflow-hidden">
                    <div class="bg-black/40 p-12 rounded-[46px] text-center border border-white/5">
                        <div class="w-24 h-24 bg-amber-500/10 rounded-full flex items-center justify-center mb-8 mx-auto border-2 border-amber-500/30">
                            <span class="text-5xl">üî≠</span>
                        </div>
                        <h3 class="hero-font text-3xl text-white mb-4">Vision Scanner</h3>
                        <p class="text-stone-400 mb-10 text-lg">Upload an image to identify the structure, its age, and its legend.</p>
                        
                        <label class="cursor-pointer block">
                            <input type="file" accept="image/*" class="hidden" onchange="simulateSmartScan(event)">
                            <div class="btn-gold w-full py-6 rounded-3xl flex items-center justify-center gap-4">
                                <span>INITIALIZE SCAN</span>
                                <span class="text-2xl">‚Üí</span>
                            </div>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto py-12 md:py-24 px-6 relative z-10">
        <div id="section-header" class="flex flex-col items-center mb-20 reveal">
            <h2 class="hero-font text-3xl md:text-4xl tracking-[0.3em] text-amber-500 mb-4">EXPLORE PORTALS</h2>
            <div class="w-32 h-1 bg-gradient-to-r from-transparent via-amber-500 to-transparent"></div>
        </div>
        
        <div id="view-categories" class="grid grid-cols-1 md:grid-cols-3 gap-10">
            <div onclick="showCategory('jyotirlingas')" class="glass-card rounded-[40px] overflow-hidden cursor-pointer h-[400px] md:h-[480px] group border-white/10">
                <div class="h-3/4 relative overflow-hidden">
                    <img src="images/jyotirlingas .jpg" class="w-full h-full object-cover group-hover:scale-110 transition duration-1000">
                    <div class="absolute inset-0 bg-gradient-to-t from-black"></div>
                </div>
                <div class="p-8"><h3 class="text-2xl hero-font text-amber-500 tracking-widest">JYOTIRLINGAS</h3></div>
            </div>

            <div onclick="showCategory('nashik_temples')" class="glass-card rounded-[40px] overflow-hidden cursor-pointer h-[400px] md:h-[480px] group border-white/10">
                <div class="h-3/4 relative overflow-hidden">
                    <img src="images/HAR har Mahadev üïâÔ∏èüïâÔ∏èüïâÔ∏è.jpeg" class="w-full h-full object-cover group-hover:scale-110 transition duration-1000" alt="Nashik Aarti">
                    <div class="absolute inset-0 bg-gradient-to-t from-black"></div>
                </div>
                <div class="p-8"><h3 class="text-2xl hero-font text-amber-500 tracking-widest">NASHIK SIHASTA</h3></div>
            </div>

            <div onclick="showCategory('forts')" class="glass-card rounded-[40px] overflow-hidden cursor-pointer h-[400px] md:h-[480px] group border-white/10">
                <div class="h-3/4 relative overflow-hidden">
                    <img src="images/FORT2.jpg" class="w-full h-full object-cover group-hover:scale-110 transition duration-1000">
                    <div class="absolute inset-0 bg-gradient-to-t from-black"></div>
                </div>
                <div class="p-8"><h3 class="text-2xl hero-font text-amber-500 tracking-widest">HISTORIC FORTS</h3></div>
            </div>
        </div>

        <div id="scanning-view" class="hidden fixed inset-0 z-[200] bg-black/95 flex items-center justify-center p-6 backdrop-blur-3xl">
            <div class="relative max-w-md w-full aspect-[4/5] glass-card rounded-[48px] overflow-hidden border-2 border-amber-500/50">
                <div class="scanner-line"></div>
                <img id="scanned-image-preview" class="w-full h-full object-cover opacity-50">
                <div class="absolute inset-0 flex flex-col items-center justify-center">
                    <p class="text-2xl hero-font text-amber-500 animate-pulse tracking-widest">IDENTIFYING STRUCTURE...</p>
                </div>
            </div>
        </div>

        <div id="view-list" class="hidden grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8"></div>

        <div id="view-detail" class="hidden max-w-6xl mx-auto glass-card text-white rounded-[50px] shadow-2xl reveal border border-white/10 overflow-hidden">
            <div class="lg:flex">
                <div class="lg:w-1/2 relative">
                    <img id="detail-img" class="w-full h-[400px] lg:h-[650px] object-cover">
                    <button onclick="open360()" class="absolute bottom-6 left-6 md:bottom-10 md:left-10 btn-gold px-8 md:px-12 py-4 md:py-5 rounded-2xl font-black flex items-center gap-4">
                        <span>ü•Ω</span> VR PORTAL
                    </button>
                </div>
                <div class="p-8 md:p-12 lg:w-1/2 overflow-y-auto max-h-[650px] bg-black/40 backdrop-blur-md">
                    <h2 id="detail-title" class="text-3xl md:text-5xl hero-font text-amber-500 mb-6 border-b border-white/10 pb-6"></h2>
                    <div class="flex gap-3 mb-8">
                        <button onclick="speakAI('en')" class="bg-white/10 px-4 md:px-6 py-2 rounded-lg font-bold hover:bg-amber-500 hover:text-black transition">EN üéß</button>
                        <button onclick="speakAI('hi')" class="bg-white/10 px-4 md:px-6 py-2 rounded-lg font-bold hover:bg-amber-500 hover:text-black transition">HI üéß</button>
                        <button onclick="speakAI('mr')" class="bg-white/10 px-4 md:px-6 py-2 rounded-lg font-bold hover:bg-amber-500 hover:text-black transition">MR üéß</button>
                    </div>
                    <p id="detail-story" class="text-stone-300 leading-relaxed mb-10 text-lg md:text-xl italic-font"></p>
                    <div id="quiz-box" class="bg-white/5 p-6 md:p-8 rounded-[32px] border border-white/10">
                        <p id="quiz-q" class="font-bold text-lg md:text-xl mb-6 text-amber-500 hero-font"></p>
                        <div id="quiz-options" class="grid gap-3"></div>
                        <p id="quiz-feedback" class="mt-4 text-center font-bold"></p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div id="whisper-overlay" class="fixed bottom-0 left-0 w-full p-8 md:p-12 z-[250] bg-black/90 border-t border-amber-500/30 backdrop-blur-xl">
        <div class="max-w-4xl mx-auto flex items-center gap-8">
            <div class="w-12 h-12 md:w-14 md:h-14 bg-amber-500 rounded-full flex items-center justify-center text-black font-black text-2xl hero-font shadow-lg shrink-0">E</div>
            <p id="whisper-text" class="text-lg md:text-2xl italic-font text-white"></p>
        </div>
    </div>

    <script src="js/data.js"></script>
    <script>
        // --- 2. LOGOUT & USER DISPLAY LOGIC ---
        document.addEventListener('DOMContentLoaded', () => {
            const userEmail = localStorage.getItem('currentUser');
            const loginBtn = document.getElementById('loginBtn');
            const userProfile = document.getElementById('userProfile');
            const nameDisplay = document.getElementById('userNameDisplay');

            if (userEmail) {
                loginBtn.classList.add('hidden');
                userProfile.classList.remove('hidden');
                nameDisplay.innerText = userEmail.split('@')[0];
            }
        });

        function handleLogout() {
            localStorage.removeItem('isLoggedIn');
            localStorage.removeItem('currentUser');
            window.location.replace("login.html");
        }

        // --- EXISTING WEBSITE LOGIC ---
        let currentItem = null;

        function simulateSmartScan(event) {
            const file = event.target.files[0];
            if (!file) return;
            const fileName = file.name.toLowerCase();
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('scanned-image-preview').src = e.target.result;
                document.getElementById('scanning-view').classList.remove('hidden');
                setTimeout(() => {
                    document.getElementById('scanning-view').classList.add('hidden');
                    let matched = false;
                    for (let cat in heritageData) {
                        heritageData[cat].forEach(item => {
                            if (fileName.includes(item.id.toLowerCase()) || fileName.includes(item.name.toLowerCase().split(' ')[0])) {
                                showDetail(cat, item.id); matched = true;
                            }
                        });
                        if(matched) break;
                    }
                    if(!matched) showDetail('jyotirlingas', 'tri');
                }, 3000);
            };
            reader.readAsDataURL(file);
        }

        function showCategory(cat) {
            document.getElementById('hero-section').classList.add('hidden');
            document.getElementById('section-header').classList.add('hidden');
            document.getElementById('view-categories').classList.add('hidden');
            
            const listDiv = document.getElementById('view-list');
            listDiv.classList.remove('hidden');
            document.getElementById('backBtn').classList.remove('hidden');
            listDiv.innerHTML = '';

            heritageData[cat].forEach(item => {
                listDiv.innerHTML += `
                    <div onclick="showDetail('${cat}', '${item.id}')" class="glass-card rounded-[32px] overflow-hidden cursor-pointer group active:scale-95 transition-all">
                        <div class="h-64 md:h-80 w-full overflow-hidden">
                            <img src="${item.img}" class="w-full h-full object-cover group-hover:scale-110 transition duration-700">
                        </div>
                        <div class="p-8 text-center">
                            <h3 class="hero-font text-amber-500 tracking-[0.2em] text-xl md:text-sm uppercase font-bold">
                                ${item.name}
                            </h3>
                            <p class="text-stone-500 text-[10px] mt-2 tracking-widest uppercase">Tap to Explore Legend</p>
                        </div>
                    </div>`;
            });
            window.scrollTo(0,0);
        }

        function showDetail(cat, id) {
            document.getElementById('hero-section').classList.add('hidden');
            document.getElementById('section-header').classList.add('hidden');
            document.getElementById('view-categories').classList.add('hidden');
            document.getElementById('view-list').classList.add('hidden');
            document.getElementById('view-detail').classList.remove('hidden');
            document.getElementById('backBtn').classList.remove('hidden');
            
            currentItem = heritageData[cat].find(x => x.id === id);
            document.getElementById('detail-img').src = currentItem.img;
            document.getElementById('detail-title').innerText = currentItem.name;
            document.getElementById('detail-story').innerText = currentItem.story;
            document.getElementById('quiz-q').innerText = currentItem.quiz.q;
            
            const optDiv = document.getElementById('quiz-options');
            optDiv.innerHTML = '';
            currentItem.quiz.options.forEach((opt, i) => {
                const b = document.createElement('button');
                b.innerText = opt;
                b.className = "text-left p-4 border border-white/10 rounded-xl hover:bg-amber-500 hover:text-black transition font-semibold";
                b.onclick = () => {
                    const f = document.getElementById('quiz-feedback');
                    if(i === currentItem.quiz.correct) { 
                        f.innerText = "‚úÖ ANALYSIS CONFIRMED"; 
                        f.className="mt-4 text-green-400 font-bold"; 
                    } else { 
                        f.innerText = "‚ùå RE-SCANNING REQUIRED"; 
                        f.className="mt-4 text-red-400 font-bold"; 
                    }
                };
                optDiv.appendChild(b);
            });
            window.scrollTo(0,0);
        }

        function speakAI(lang) {
            window.speechSynthesis.cancel();
            const text = currentItem.whisper[lang];
            document.getElementById('whisper-text').innerText = text;
            document.getElementById('whisper-overlay').classList.add('active');
            const u = new SpeechSynthesisUtterance(text);
            u.lang = lang === 'mr' ? 'mr-IN' : (lang === 'hi' ? 'hi-IN' : 'en-IN');
            u.onend = () => document.getElementById('whisper-overlay').classList.remove('active');
            window.speechSynthesis.speak(u);
        }

        function open360() { window.open(currentItem.map360, '_blank'); }
        function goBack() { location.reload(); }
    </script>
</body>
</html>